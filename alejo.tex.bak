\section{A review of Pauli maps of qubits} % {{{
\janote{Pauli maps, no PCE, me parece a mí}
% 
\subsection{Single qubit} % {{{ 
We can write any quantum state associated to a qubit in the Bloch sphere parametrization as
% 
\begin{equation}
\rho=\frac{1}{2}\sum_{\alpha=0}^{3} r_{\alpha} \sigma_{\alpha}.
\label{rho2}
\end{equation}
% 
Moreover, it is possible to define a quantum map capable of modifying each of the coefficients $r_{\alpha}$, these are known as \textit{Pauli maps}
% 
\begin{equation}
\rho \to \rho'=\mathcal{E}[\rho ]=\frac{1}{2}\sum_{\alpha=0}^{3} \tau_{\alpha} r_{\alpha} \sigma_{\alpha},
\label{Pauli_Map}
\end{equation}
% 
with $-1\leq \tau_{\alpha} \leq 1$. 

We now turn to find the matrix form of the map $\mathcal{E}$ in order to construct the Choi matrix and the conditions the set of parameters $\{\tau_{\alpha}\}$ need to satisfy in order to $\mathcal{E}$ be considered a quantum channel. By writing the density matrix in vector form $\kket{\rho}=2^{-1}\sum_{\alpha=0}^{3} r_{\alpha} \kket{\sigma_{\alpha}}$, the matrix form of the map $\mathcal{E}$ may be written as
% 
\begin{equation}
\hat{\mathcal{E}} = \frac{1}{2}\sum_{\alpha=0}^{3} \tau_{\alpha} \ddyada{\sigma_{\alpha}},
% \label{Map_Pauli}
\end{equation}
%
where the kets $\kket{\sigma_{\alpha}}$ correspond to the vectorized elements of the Pauli basis and satisfy the usual relation $ \bbrakket{{\sigma_{\alpha} }}{{\sigma_{\alpha'} }} = \tr \left(\sigma_{\alpha}^{\dagger} \sigma_{\alpha'}\right) = 2 ~\delta_{\alpha\alpha'}$. After some steps it is possible to show that the associated Choi matrix reads
% 
\begin{equation}
 \mathcal{D} = \frac{1}{2}\sum_{\alpha=0}^{3} \tau_{\alpha} \sigma_{\alpha} \otimes \sigma_{\alpha}^*.
%  \label{Choi_1}
\end{equation}
% 
Moreover, observe that $\mathcal{D}$ has the same form as the matrix representation of a random unitary channel, with Kraus operators given by $K_{\alpha}=\sqrt{\tau_{\alpha}/2}\sigma_{\alpha}$ \cite{CHRUSCINSKI20131425}. In this way the Choi matrix $\mathcal{D}$ is diagonal in the Pauli basis (see Appendix for details),
%
\begin{equation}
 \mathcal{D} \kket{\sigma_{\alpha}}= \lambda_{\alpha} \kket{\sigma_{\alpha}},
\end{equation}
% 
with eigenvalues given by 
% 
\begin{equation}
 \lambda_{\alpha} = \sum_{\beta=0}^3\sa_{\alpha\beta}\tau_{\beta},
\end{equation}
%
or more compactly $\vec{\lambda} = \sa~\vec{\tau}$, where $\sa=2^{-1}H\otimes H$ and $H$ is the Hadamard matrix,
%
\begin{equation}
 H=\begin{pmatrix}
        1 & 1\\
        1 & -1\\
    \end{pmatrix}.
 \label{Hadd_Mat}
\end{equation}
% 
% }}}
\subsection{$N$ qubits} % {{{
% 
For the case of $N$ qubits, the density matrix may be written as
% 
\begin{equation}
\rho=\frac{1}{2^N}\sum_{\vec{\alpha}} r_{\vec{\alpha}} \sigma_{\vec{\alpha}}.
% \label{rho2}
\end{equation}
% 
Analogously to the single qubit case, one can define the $N$-qubits Pauli map $\mathcal{E}_N$
% 
\begin{equation}
\rho \to \rho'=\mathcal{E}_N[\rho ]=\frac{1}{2^N}\sum_{\vec{\alpha}} \tau_{\vec{\alpha}} r_{\vec{\alpha}} \sigma_{\vec{\alpha}},
% \label{Pauli_Map}
\end{equation}
% 
with $-1\leq \tau_{\vec{\alpha}} \leq 1$. 
% 
In this case the density matrix in vector form holds 
% 
\begin{equation}
 \kket{\rho}=\frac{1}{2^N}\sum_{\vec{\alpha}} r_{\vec{\alpha}} \kket{\sigma_{\vec{\alpha}} },
\end{equation}
% 
where $\kket{\sigma_{\vec{\alpha} }}=\kket{\sigma_{\alpha_1}}\otimes\dots \otimes\kket{\sigma_{\alpha_N}}$, and satisfy the usual orthogonality relation $\bbrakket{{\sigma_{\vec{\alpha} } }}{{\sigma_{\vec{\alpha}'} }} = \tr \left(\sigma_{\vec{\alpha}}^{\dagger} \sigma_{\vec{\alpha}'}\right) = 2^N ~\delta_{\vec{\alpha}\vec{\alpha}'}$. The matrix representation of this map is given by
% 
\begin{equation}
\hat{\mathcal{E}}_N = \frac{1}{2^N}\sum_{\vec{\alpha}} \tau_{\vec{\alpha}} \ddyada{\sigma_{\vec{\alpha}} }.
% \label{Map_Pauli}
\end{equation}
%
As in the previous case, the Choi matrix $\mathcal{D}_N$ may be written in terms of tensor products of Pauli matrices
% 
\begin{equation}
 \mathcal{D}_N = \frac{1}{2^N}\sum_{\vec{\alpha}} \tau_{\vec{\alpha}}  \bigotimes_{j=1}^N \sigma_{\alpha_j} \otimes \sigma_{\alpha_j}^*.
%  \label{Choi_1}
\end{equation}
% 
After several steps, it is possible to prove that analogously to the single qubit case, $\mathcal{D}_N$ is diagonal in the $N$-qubits Pauli basis
%
\begin{equation}
 \mathcal{D}_N \kket{\sigma_{\vec{\alpha} }}= \lambda_{\vec{\alpha}} \kket{\sigma_{\vec{\alpha} }},
\end{equation}
% 
with eigenvalues $\lambda_{\vec{\alpha}}$ given by 
% 
\begin{equation}
 \lambda_{\vec{\alpha}} = \sum_{\vec{\beta}} \san_{\vec{\alpha}\vec{\beta}}\tau_{\vec{\beta}},
\end{equation}
%
where 
% 
\begin{equation}
 \san=\sa^{\otimes N}=\frac{1}{2^N}\left(H\otimes H\right)^{\otimes N}=\left(\frac{H}{\sqrt{2}}\right)^{\otimes 2N}.
\end{equation}
%
% }}}
% }}}
\section{Bloch-like parametrization for qudits: Weyl operator basis} % {{{
% 
One of the ways we can generalize the Bloch parametrization for individual high dimensional quantum systems (or qudits), is to employ the so called \textit{Weyl basis} \cite{Bertlmann2008}. Under this parametrization any density matrix $\rho$ may be written as
% 
\begin{equation}
\rho=\sum_{mn=0}^{d-1} \alpha_{mn} U_{mn},
\label{rho}
\end{equation}
% 
where $U_{mn}$ are the Weyl operators, given by
% 
\begin{equation}
U_{mn}=\sum_{j=0}^{d-1}\omega_d^{j m}\dyad{j}{j\oplus n},
\label{Umn}
\end{equation}
% 
and $\omega_d=\exp(2\pi i/d)$ is the primitive $d$-th root of unity. Note that for the case of qubits ($d=2$), the set $\{U_{mn}\}$ reduces to the Pauli matrices and the identity (see Fig. \ref{Weyl_Pauli}).

\begin{figure}[h]
  \centering
  \includegraphics[scale=0.65]{Weyl_2.pdf}
  \caption{Relation between Weyl operators and Pauli matrices. Note that the Weyl operators may also be employed to generalize some usual unital channels. Taken from \cite{Fonseca2019}.}
  \label{Weyl_Pauli}
\end{figure}
% 
Due to the fact that the Weyl operators are not Hermitian \janote{por qué?}, then the coefficients $\alpha_{mn}$ are in general complex.
\subsection{Propiedades de las matrices de Weyl} % {{{
Se definen las matrices de Weyl como:
\begin{align*}
U_{mn} = \sum_{k = 0}^{d-1} \omega_d^{km} |k\rangle \langle k \oplus n |,
\end{align*}
con $\omega_d = \exp(2\pi  i /d)$. Se pueden demostrar algunas propiedades de las matrices de Weyl, entre ellas se demuestra que:
\begin{align*}
U_{mn} U_{pq} U_{mn}^{\dagger} & = \sum_{k = 0}^{d-1} \omega_d^{km} |k\rangle \langle k \oplus n |   \sum_{j = 0}^{d-1} \omega_d^{jp} |j\rangle \langle j \oplus q |   \sum_{l = 0}^{d-1} \omega_d^{-lm} | l \oplus n\rangle \langle l| \\
& = \sum_{k,j,l=0}^{d-1} \omega_d^{km+jp-lm} |k \rangle \langle k \oplus n| j \rangle \langle j \oplus q | l \oplus n| \langle l | \\
& = \sum_{k,j,l=0}^{d-1} \omega_d^{km+jp-lm} \; \delta_{k\oplus n, j} \delta_{j\oplus q, l \oplus n} |k \rangle \langle l | \\
& = \sum_{k,l=0}^{d-1} \omega_d^{km + (k + n)p - lm} \delta_{k \oplus n \oplus q , l \oplus n} |k \rangle \langle l | \\
&= \sum_{k=0}^{d-1} \omega_d^{km + (k+n)p - (k+q)m} |k \rangle \langle k \oplus q | \\
& = \sum_{k=0}^{d-1} \omega_d^{np-mq} \sum_{k=0}^{d-1} \omega_d^{kp} |k \rangle \langle k \oplus q | \\
&=  \omega_d^{np-mq} U_{pq} 
\end{align*}
Es decir, concluimos que
\begin{align}
\label{conmutación matrices de Weyl}
U_{mn} U_{pq} U_{mn}^{\dagger}  = \omega_d^{np-mq} U_{pq} 
\end{align}

% }}}
% }}}


\section{Weyl maps of qudits} % {{{

\subsection{Definition of a single-qudit Weyl map and its Choi matrix}
Consider the generalization of a Pauli map for a single-qudit as
% 
\begin{equation}
\rho \to \rho'=\mathcal{E}[\rho ]=\sum_{m,n=0}^{d-1} \tau_{mn} \alpha_{mn} U_{mn},
\label{Weyl_Map}
\end{equation}
% 
with $-1\leq \tau_{mn} \leq 1$. 

Our task is now to find the associated matrix form 
\janote{of the map [?]}. For this let write $\rho$ in vector form
% 
\begin{equation}
\ket{\rho} = \sum_{m,n=0}^{d-1} \alpha_{mn} \ket{U_{mn}},
% \label{Weyl_Map}
\end{equation}
% 
with
% 
\begin{equation}
\ket{U_{mn}}=\sum_{j=0}^{d-1}\omega_d^{j m}\ket{j,j\oplus n}.
\label{Ket_U}
\end{equation}
% 
From this, it can be easily seen that the matrix form of the map in Eq. \ref{Weyl_Map} can be written as
% 
\begin{equation}
\hat{\mathcal{E}} = \frac{1}{d}\sum_{m,n=0}^{d-1} \tau_{mn} \dyad{U_{mn}},
\label{Map_Pauli}
\end{equation}
% 
where we have used the fact that
% 
\begin{equation}
 \tr \left(U_{mn}^{\dagger} U_{kl}\right) = \braket{{U_{mn}} }{{U_{kl} }} = d ~\delta_{mk}\delta_{nl}.
\end{equation}
% 
By substituting Eq. \ref{Ket_U} in Eq. \ref{Map_Pauli}, we obtain the matrix form of the map in the computational basis
% 
\begin{equation}
 \hat{\mathcal{E}}_c = \frac{1}{d}\sum_{jk\mu\nu=0}^{d-1} \tau_{\mu\nu}~ \omega_d^{\mu (j-k)} \dyad{j,j\oplus \nu}{k,k\oplus \nu}.
\end{equation}
% 
Applying the reshuffling operation and after some steps it is possible to see that the Choi matrix reads
% 
\begin{align}
 \mathcal{D} &=  \frac{1}{d}\sum_{jk\mu\nu=0}^{d-1} \tau_{\mu\nu}~ \omega_d^{\mu (j-k)} \dyad{j,k}{j\oplus \nu,k\oplus \nu},\\
 & = \frac{1}{d}\sum_{\mu\nu=0}^{d-1} \tau_{\mu\nu} ~U_{\mu\nu}\otimes U_{\mu\nu}^*.
 \label{Choi_1}
\end{align}
% 
This expression is valid for arbitrary $d$ and may provide some hints into the search of a simpler form for the proof of the diagonalization of $\mathcal{D}$. In particular, for $d=2$ we have
%  
\begin{equation}
  \mathcal{D} = \frac{1}{2}\sum_{\mu=0}^{3} \tau_{\mu} ~\sigma_{\mu}\otimes \sigma_{\mu}^*,
\end{equation}
% 
note that in the last expression we have used one index instead of two binary ones.

\subsubsection{Numerical search of single-qutrit Weyl quantum channels} % {{{
% 
We carried out a first (non exhaustive) numerical approach in which we considered $\tau$ coefficients either equal to zero or one, for the case of a qutrit ($d=3$). In Table \ref{Table1}, we list the set of trace preserving channels found so far (however, by symmetry reasons I am almost sure there are no more channels).
% 
\begin{table}[h]
 \centering
\begin{tabular}{ |c|c|c|c|c|c| } 
\hline
$\tau$ & $D$ & $t_1$ &$t_2$ &$t_3$ & $I$\\
\hline
$\tau_{00}$ & 1 & 1 & 1 & 1& 1\\ 
\hline
$\tau_{01}$ &  & 1 & && 1\\ 
\hline
$\tau_{02}$ & & 1 & && 1\\ 
\hline
$\tau_{10}$ & &  & 1 & & 1\\ 
\hline
$\tau_{11}$ &  &  & & 1& 1\\ 
\hline
$\tau_{12}$ &  &  & && 1\\ 
\hline
$\tau_{20}$ &  &  & 1&& 1\\ 
\hline
$\tau_{21}$ &  &  & && 1\\ 
\hline
$\tau_{22}$ &  &  & & 1& 1\\ 
\hline
\end{tabular}
\caption{List of ``Weyl component erasing'' (WCE) channels for a single qutrit. Each column shows the non-null coefficients $(\tau_{mn}=1)$ leading to real non-negative eigenvalues of the Choi matrix $\mathcal{D}$.}
\label{Table1}
\end{table}
% 

In summary, we have 5 WCE channels on qutrits:
\begin{itemize}
 \item 1 completely depolarizing channel ($D$).
 \item 3 three components channels ($t_j$).
 \item 1 Identity channel ($I$).
\end{itemize}
% }}}
% }}}
% 
\subsubsection{Analytical diagonalization of a single-qudit Choi matrix} % {{{
% 
Recalling Eq. \ref{Choi_1}, we can write the Choi matrix associated to a Weyl channel as
% 
\begin{equation}
 \mathcal{D} =  \frac{1}{d}\sum_{jk\mu\nu=0}^{d-1} \tau_{\mu\nu}~ \omega_d^{\mu (j-k)} \dyad{j,k}{j\oplus \nu,k\oplus \nu}.
\end{equation}
% 
After some steps we obtain 
% 
\begin{equation}
 \mathcal{D} =  \frac{1}{d}\sum_{kl=0}^{d-1} \left(\frac{1}{d}\sum_{\mu\nu=0}^{d-1}\tau_{\mu,\nu}~ \omega_d^{k\nu -\mu l} \right)\dyad{U_{kl}}.
\end{equation}
% 
In this way, the basis with elements $d^{-1/2}\ket{U_{kl}}$ diagonalizes the Choi matrix, and the corresponding eigenvalues read
% 
\begin{equation}
 \lambda_{kl}=\frac{1}{d}\sum_{\mu\nu=0}^{d-1}\tau_{\mu\nu}~ \omega_d^{k\nu -\mu l}.
\end{equation}
% 
Note that we recover the previous results for $d=2$, as expected. In addition, we can rewrite the above expression in vector form as
% 
\begin{equation}
 \vec{\lambda}=F\otimes F^*~\vec{\tau},
\end{equation}
% 
where $F$ is the matrix associated to a quantum Fourier transform
% 
\begin{equation}
 F=\frac{1}{\sqrt{d}}\sum_{k,l=0}^{d-1}\omega_d^{kl}\dyad{k}{l}.
\end{equation}
% 
Finally, I am almost sure that the results from the previous subsection may be
obtained using the fact that $\sum_k\omega_d^{k(m-n)}=d~\delta_{mn}$.
\cpnote{Alejo, a cuales resultados se refiere?}
% }}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%% Tomás %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{Forma de Kraus y relación entre las $\tau$ y $k$} % {{{
En esta parte definimos los mapas de Weyl y los diagonalizamos. Es una forma diferente de probarlo y faltan algunos detalles, pero es al menos una comprobación de la diagonalización de Alejo y a lo mejor incluye ideas útiles. 

Para empezar, una matriz de densidad se puede escribir como
\begin{align}
\label{mat densidad}
\rho = \sum_{m,n=0}^{d-1} \alpha_{mn} U_{mn}
\end{align}
y un mapa de Weyl se define como
\begin{align}
\label{forma de bloch}
\rho \rightarrow \rho' = \varepsilon(\rho) = \sum_{m,n = 0}^{d-1} \tau_{mn} \alpha_{mn} U_{mn}
\end{align}
Sin embargo, los canales de Weyl se pueden escribir de forma alternativa utilizando la forma de Kraus:
\begin{align}
\label{Forma de Kraus}
\varepsilon(\rho) = \sum_{m,n=0}^{d-1} k_{mn} U_{mn} \rho U_{mn}^{\dagger}.
\end{align}
\janote{Me gustaría discutir (de nuevo?) por qué podemos suponer que la 
forma de Kraus de los WCE es esta}
Haría falta probar que efectivamente todos los canales de Weyl se pueden escribir así y que todos los canales escritos así son de Weyl, pero sé por lo menos que para el caso de qubits (canales de Pauli) se cumple. La ventaja de esta representación es que el canal es completamente positivo si y sólo si $k_{mn} \geq 0$ para toda $m,n$.

Entonces, buscamos ahora una relación entre  las $k$ y las $\tau$, para lo cual partimos de \ref{Forma de Kraus} y sustituimos la expresión de $\rho$:
\begin{align*}
\varepsilon(\rho) &= \sum_{m,n=0}^{d-1} k_{mn} U_{mn} \rho U_{mn}^{\dagger} = \sum_{m,n=0}^{d-1} k_{mn} U_{mn}  \sum_{p,q=0}^{d-1} \alpha_{pq} U_{pq} U_{mn}^{\dagger} \\ 
& = \sum_{m,n,p,q=0}^{d-1} k_{mn} \alpha_{pq} U_{mn} U_{pq} U_{mn}^{\dagger}  = \sum_{m,n,p,q=0}^{d-1} k_{mn} \alpha_{pq} \omega_d^{np-mq} U_{pq} \;\;\; \text{por (\ref{conmutación matrices de Weyl})} \\
& = \sum_{p,q=0}^{d-1} \left( \sum_{m,n=0}^{d-1} k_{mn} \omega_d^{np-mq} \right) \alpha_{pq} U_{pq}
\end{align*}
Vemos que el resultado vuelve a tener la forma de \ref{mat densidad}, pero con los componentes $\alpha_{pq}$ multiplicados por el término entre paréntesis, por lo que concluimos que este término es $\tau_{pq}$, es decir:
\begin{align}
\tau_{pq} = \sum_{m,n=0}^{d-1} k_{mn} \omega_d^{np-mq}
\end{align}
Esta expresión se puede voltear multiplicando ambos lados por $\omega_d^{lq-jp}$ y sumando sobre $p, q$, con lo que nos queda:
\begin{align*}
\sum_{p,q=0}^{d-1} \tau_{pq} \omega_d^{lq-jp} = \sum_{m,n,p,q=0}^{d-1} k_{mn} \omega_d^{np-mq} \omega_d^{lq-jp} = \sum_{m,n,p,q=0}^{d-1} k_{mn} \omega_d^{p(n-j)} \omega_d^{q(l-m)}
\end{align*}
La suma sobre $p$ se puede hacer usando que $\sum_p \omega_d^{p(n-j)} = d \delta_{nj}$ y similarmente sobre $q$ se usa que $\sum_q \omega_d^{q(l-m)} = d \delta_{lm}$.  Entonces nos queda que:
\begin{align*}
\sum_{p,q=0}^{d-1} \tau_{pq} \omega_d^{lq-jp} & = d^2 \sum_{m,n=0}^{d-1} k_{mn} \delta_{n,j} \delta_{l,m} = d^2 k_{lj}
\end{align*}
y concluimos que
\begin{align}
\label{k en terminos de lambda}
k_{lj} & =  \dfrac{1}{d^2} \sum_{p,q=0}^{d-1} \tau_{pq} \omega_d^{lq-jp} 
\end{align}
Vemos que este resultado difiere de las lambdas encontradas en la diagonalización de Alejo sólo por un factor de $d$.
Como las $k$ tienen que ser mayor o iguales a $0$ para que el canal sea completamente positivo y como las lambdas difieren de las $k$ sólo por un factor de $d$,  la conclusión sobre qué canales son válidos es la misma que cuando se hace la diagonalización. 


Regresamos ahora a la diagonalización obtenida por Alejo  y encontramos algunas otras ecuaciones que usaremos luego. Dicha diagonalización dice que:
\begin{align*}
\lambda_{kl} = \dfrac{1}{d} \sum_{\mu \nu = 0}^{d-1} \tau_{\mu \nu} \omega_d^{k \nu - \mu l}
\end{align*}
Esta expresión se puede voltear de forma similar a lo que se hizo para obtener \ref{k en terminos de lambda} y resulta que:
\begin{align}
\label{tau en termino de lambda}
\tau_{pq} = \dfrac{1}{d} \sum_{mn=0}^{d-1} \lambda_{mn} \omega_d^{pn-qm}
\end{align}
A partir de esta expresión, podemos hacer $p=q=0$, con lo que nos queda:
\begin{align*}
\tau_{00} = \dfrac{1}{d} \sum_{mn=0}^{d-1} \lambda_{mn} \omega_d^0,
\end{align*}
como $\tau_{00}=1$, concluimos que:
\begin{align}
\label{suma-lambdas}
\sum_{mn}^{d-1}\lambda_{mn} = d
\end{align}
\janote{Esto es un check de algo que deberíamos esperar?}
% }}}
\subsubsection{Canales con $|\tau_{\mu\nu}|=1$ y propiedades algebráicas} % {{{
\janote{Esta sección me parece clave para nuestro interés por entender
los extremos}

\textbf{Definición, Canales con Multiplicadores de Norma Unitaria (Canales MNU):} Definimos un canal MNU
(o cambiar el nombre por uno mejor) como un canal de Weyl en el cual los
multiplicadores $\tau_{mn}$ cumplen que $|\tau_{mn}|= 1$.  Es decir, los
multiplicadores se encuentran en el círculo unitario. Notar que no incluyo por
ahora que $\tau_{mn} = 0$, pero a lo mejor se puede agregar luego. 
\cpnote{Será bueno ver que son estos canales con fases arbitrarias para qubits.}
\janote{Sí, jugándole con Tomás vimos que eso hacen ademśa de intercambiar
los estados. Estos canales que
él define aquí tenemos la fuerte intuición de que se corresponden con
los extremos.}

\paragraph{Propiedades de Canales MNU}

\textbf{Teorema 1:} \textit{En un canal de Weyl, si $|\tau_{pq}| = 1$, entonces $\tau_{pq} = \omega_d^{k}$ para algún entero $k$. Por lo tanto, los únicos multiplicadores que hay que tomar en cuenta en canales MNU son los que sean raíces $d$-ésimas de la unidad.} \\

\textbf{Dem:} Partiendo de \ref{tau en termino de lambda}, tenemos que
\begin{align*}
& \tau_{pq} = \dfrac{1}{d} \sum_{mn=0}^{d-1} \lambda_{mn} \omega_d^{pn-qm} .
\end{align*}
Entonces, $\tau_{pq}$ es una suma convexa de varias raíces d-ésimas 
de la unidad (convexa porque la suma de los coeficientes $\lambda_{mn}/d$ es igual a $1$ y estos coeficientes son $\geq 0$ para ser un canal CP). 
Por lo tanto, los posibles valores de $\tau_{pq}$ se encuentran 
en la envoltura convexa de estas raíces $\omega_d^{pn-qm}$,
lo cual forma un polígono con vértices en las raíces. 
Pero además, $\tau_{pq}$ se encuentra en el círculo unitario, debido a que $|\tau_{pq}| = 1$. 
Por lo tanto, los posibles  valores de $\tau_{pq}$ tienen que ser la intersección
del círculo unitario con el polígono, que son justamente los vértices en las raíces. \\
Por lo tanto, si $\tau_{pq}$ se encuentra en el círculo unitario, 
tiene que ser una raíz d-ésima de la unidad.  $ \blacksquare$ 
\janote{A este argumento tenemos que ponerle el ojo, podría ser 
lo que necesitamos para los extremos.} \\

Por lo tanto, en los canales MNU se puede considerar 
que los multiplicadores $\tau$ son siempre raíces de la unidad. \\

Con estos resultados podemos probar un lema que luego nos lleva a un teorema:\\




\textbf{Lema:} \textit{$\tau_{pq} = \omega_d^k$ (es decir, es una raíz $d$-ésima de la unidad) si  y sólo si $\lambda_{mn} = 0$ para todo $mn$ con $\omega_d^{pn-qm} \neq \omega_d^k$} \\

\textbf{Ida:}  Partiendo de \ref{tau en termino de lambda}, tenemos que:
\begin{align*}
& \omega_d^k = \tau_{pq}  \; \Rightarrow \; \omega_d^k = \dfrac{1}{d} \sum_{mn=0}^{d-1} \lambda_{mn} \omega_d^{pn-qm} \\
& \Rightarrow \; d = \sum_{mn=0}^{d-1} \lambda_{mn} \omega_d^{-k} \omega_d^{pn-qm} \\
& \Rightarrow \; 0 = \sum_{mn}^{d-1} \omega_d^{-k} \omega_d^{pn-qm} - \sum_{mn=0}^{d-1}\lambda_{mn} \;\; \text{por (\ref{suma-lambdas})} \\
& \Rightarrow \; 0 = \sum_{mn=0}^{d-1} \lambda_{mn} \left( \omega_d^{pn-qm-k} - 1 \right) 
\end{align*}
Como $\lambda_{mn} \geq 0$ para toda $mn$ (por completa positividad) y $\omega_d^{pn-qm-k} - 1$ tiene parte real menor o igual a $0$, entonces $\lambda_{mn} \left( \omega_d^{pn-qm-k} - 1 \right) $ tiene parte real menor o igual a $0$ y para que sumar sobre todas las $mn$ nos dé $0$, todos los sumandos tienen que ser $0$:
\begin{align*}
& \lambda_{mn} \left( \omega_d^{pn-qm-k} - 1 \right) = 0
\end{align*}
Entonces, si $\omega_d^{pn-qm-k} \neq 1$, se debe de tener que $\lambda_{mn} = 0$, que es lo que se quería probar. \\

\textbf{Regreso:} Consideramos que:
\begin{align*}
\tau_{pq}& = \dfrac{1}{d} \sum_{mn=0}^{d-1} \lambda_{mn} \omega_d^{pn-qm} \\
&= \dfrac{1}{d} \sum_{mn | \omega_d^{pn-qm} = \omega_d^k} \lambda_{mn} \omega_d^{pn-qm} +\dfrac{1}{d} \sum_{mn | \omega_d^{pn-qm} \neq \omega_d^k} \lambda_{mn} \omega_d^{pn-qm} \\
& = \dfrac{1}{d} \sum_{mn | \omega_d^{pn-qm} = \omega_d^k} \lambda_{mn} \omega_d^k + 0 \;\;\; \text{(por hipótesis, $ \lambda_{mn} = 0$ cuando $ \omega_d^{pn-qm} \neq \omega_d^k)$.} \\
& =  \dfrac{1}{d} \omega_d^k \sum_{mn | \omega_d^{pn-qm} = \omega_d^k} \lambda_{mn}
\end{align*}
Pero como las lambdas de la suma que quedan son las únicas distintas de $0$, la ecuación \ref{suma-lambdas} implica que esta suma es igual a $d$ y por lo tanto $\tau_{pq} = \omega_d^k$. $\blacksquare$ \\

\textbf{Teorema 2 (Propiedad algebráica):}  \textit{Si $\tau_{pq} = \omega_d^k$ y $\tau_{p'q'} = \omega_d^{k'}$ (es decir, tenemos que dos taus son raíces $d$-ésimas de la unidad), entonces se tiene que $\tau_{p \oplus p' , q \oplus q'} = \tau_{pq} \tau_{p'q'} = \omega_d^{k+k'}$.} \\

\textbf{Demostración:} Vamos a usar el regreso del lema, para lo que empezamos probando su hip\'otesis. Digamos que $\omega_d^{(p \oplus p') n - (q \oplus q')m} \neq \omega_d^{k+k'}$, lo que implica que $\omega_d^{p n - qm} \omega_d^{p'n - q'm} \neq \omega_d^{k+k'}$. \\
Para que se cumpla esto, se debe de tener que $ \omega_d^{p n - qm} \neq \omega_d^k$ o bien $\omega_d^{p'n-q'm} \neq \omega_d^{k'}$. \\

Si $\omega_d^{p n - qm} \neq \omega_d^k$ y como $\tau_{pq} = \omega_d^k$, la ida del lema implica que $\lambda_{mn} =0$. Por otro lado, si $\omega_d^{p'n-q'm} \neq \omega_d^{k'}$ y como $\tau_{p'q'} = \omega_d^{k'}$, la ida del lema implica que $\lambda_{mn} = 0$. En cualquier caso, concluimos que $\lambda_{mn} = 0$. \\

Entonces, hemos demostrado que $\omega_d^{(p \oplus p')n - (q\oplus q')m} \neq \omega_d^{k+k'}$ implica que $\lambda_{mn} = 0$, por lo que el regreso del lema implica que $\tau_{p \oplus p', q \oplus q'} = \omega_d^{k+k'}$ $\;\; \blacksquare$. \\

En particular, eso muestra que el conjunto de taus que valen 1 es cerrado bajo $\oplus$ (pues si $\tau_{pq}= 1$ y $\tau_{p'q'}=1$, el teorema dice que $\tau_{p\oplus p', q\oplus q'} = \tau_{pq} \tau_{p'q'} = 1$).  \\

Con este teorema se puede probar los canales MNU son justo los que se obtienen cuando las taus son las columnas de la matriz $a$ (generalizada al caso de $d$ niveles, donde se  puede definir como $a_{mnpq} = \omega_{d}^{np-mq}$ y después ``colapsarla'' a dos índices). Es decir, el siguiente teorema:\\

\textbf{Teorema 3:} \textit{Sólo hay $d^2$ canales MNU válidos. Cada uno consiste en una elección de taus de la forma $\tau_{pq} = \omega_d^{np-mq}$ (columnas de la matriz $a$) para alguna elección de $m,n$ de las $d^2$ posibles.}\\

Para probarlo, vemos primero que solamente hay $d^2$ canales MNU posibles. Para ver esto, notamos por el teorema 2 que si conocemos $\tau_{01}$ y $\tau_{10}$, todas las otras taus (y por tanto el canal completo) quedan determinadas. Esto debido a que cualquier $\tau_{pq}$ se va a poder calcular como productos de $\tau_{01}$ y $\tau_{10}$ usando la conclusión del teorema 2.  Como hay $d$ posibilidades para el valor de $\tau_{01}$ y de $\tau_{10}$, tenemos un total de a lo sumo  $d^2$ canales distintos. 

Por otro lado, se puede demostrar que si elegimos $\tau_{\mu\nu} = \omega_d^{m\nu-\mu n}$ para alguna elección de $m,n \in \{0,1, \cdots , d-1\}$ (es decir, alguna columna de $a$), entonces estas taus definen un canal válido. Para probarlo solamente hay que usar la diagonalización para esta elección de taus y ver que todas las lambdas son no negativas y reales:
\begin{align*}
\lambda_{kl} &= \dfrac{1}{d} \sum_{\mu \nu = 0}^{d-1} \tau_{\mu\nu} \omega_d^{k\nu-\mu l} \\
& = \dfrac{1}{d} \sum_{\mu \nu = 0}^{d-1} \omega_d^{m\nu-\mu n} \omega_d^{k\nu-\mu l} \\
& = \dfrac{1}{d} \sum_{\mu\nu = 0}^{d-1} \omega_d^{\nu (m+k)} \omega_d^{-\mu(\nu + l)}  \\
& = \dfrac{1}{d} \sum_{\mu=0}^{d-1} \omega_d^{-\mu(n + l)} \sum_{\nu=0}^{d-1} \omega_d^{\nu(m+k)} \\
&= \dfrac{1}{d} d \delta_{n,-l} d \delta_{m,-k} \;\;\; \text{Por propiedad que menciona alejo justo antes de la seccion 5}  \\
& = d \delta_{n,-l} \delta_{m,-k}
\end{align*}
Entonces, todas las lambdas son positivas, en particular, todas menos una valen $0$ y la otra (la de índices $(-m,-l)$) vale $d$.\\

Además, elecciones distintas de $m,n$ dan lugar a canales distintos, por lo que hemos encontrado $d^2$ canales distintos. 

Como vimos que hay a lo sumo $d^2$ canales MNU distintos y ya encontramos $d^2$ canales, concluimos que los canales MNU son exactamente esos. Es decir, los canales MNU son exactamente aquéllos de la forma $\tau_{pq}  =\omega_d^{np-mq}$ para las distintas elecciones de $m,n$. $\blacksquare$ \\ \\

Dejo aquí algunos dibujos de la matriz $a_{nmpq} = \omega_d^{np-mq}$ colapsada a dos dimensiones (en la horizontal el índice es $dm+n$ y en la vertical $dp+q$) para distintos valores de $d$. Cada entrada la pongo en un color desde el blanco para la raíz $\omega_d^0 = 1$ hasta negro para la última raíz $\omega_d^{d-1}$. Como se dijo antes, las columnas de esta matriz son los $d^2$ canales válidos, cada uno es $\tau_{pq} = \omega_d^{np-mq}$. 


\begin{figure}
    \centering
    \subfloat[\centering $d=2$]{{\includegraphics[width=5cm]{imagenes/d2.png} }}%
    \qquad
    \subfloat[\centering $d=4$]{{\includegraphics[width=5cm]{imagenes/d4.png} }} \\%
\centering
    \subfloat[\centering $d=10$]{{\includegraphics[width=5cm]{imagenes/d10.png} }}%
    \qquad
    \subfloat[\centering $d=12$]{{\includegraphics[width=5cm]{imagenes/d12.png} }}\\%
\centering
\subfloat[\centering $d=13$]{{\includegraphics[width=5cm]{imagenes/d13.png} }}%
    \qquad
    \subfloat[\centering $d=17$]{{\includegraphics[width=5cm]{imagenes/d17.png} }}%
\end{figure}
% }}}
\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%% Tomás %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Generalization to $N$ qudits (in progress...)} % {{{
% 
In analogy to the problem of two level systems, the generalization to the case
of arbitrary number of qudits is relatively straightforward. Work in
progress... 
% }}}


